# 方向零：Dynamic Feature Pool 的重新实现

以下是整理后的 Markdown 格式内容，数学公式使用 `$...$` 或 `$$...$$` 括起：

---

给定锚点特征集 $ F^a \in \mathbb{R}^{N \times D} = [f_1^a, f_2^a, ..., f_N^a] $，其中 $ N $ 和 $ D $ 分别表示样本数量和特征维度（通道数）。我们首先计算锚点特征集的二阶统计量。具体来说，将 $ D $ 个特征维度视为 $ D $ 个变量，并将锚点集视为 $ N $ 个观测样本，计算这些通道之间的协方差矩阵 $ \Sigma \in \mathbb{R}^{D \times D} $，其定义如下：

$$
\Sigma = \frac{1}{N - 1}(F^a - \mu \mathbf{1}^T)(F^a - \mu \mathbf{1}^T)^T,
$$

其中均值向量 $ \mu \in \mathbb{R}^D $ 定义为：

$$
\mu = \frac{1}{N} F^a,
$$

用于对特征进行中心化处理。

由于两个具有大方差的变量即使关系较弱也可能产生较大的协方差，因此我们进一步构造相关性矩阵 $ R $，从协方差矩阵 $ \Sigma $ 中标准化变量间的关系，以消除不同尺度或方差的影响：

$$
R = A^{-1} \Sigma A^{-1},
$$

其中 $ A $ 是一个对角矩阵，其对角线元素是各变量的标准差：

$$
A = \text{diag}(\sigma_1, ..., \sigma_u, ..., \sigma_D), \quad \sigma_u = \sqrt{\Sigma_{uu}}.
$$

第 $ u $ 个和第 $ v $ 个变量之间的相关性可以表示为：

$$
R_{uv} = \frac{\Sigma_{uv}}{\sigma_u \sigma_v}.
$$

在得到相关性矩阵 $ R $ 后，我们从中提取 $ M $ 个主要的共变关系（co-varying relationships）跨锚点特征维度。具体而言，我们对矩阵 $ R $ 进行特征分解，将其分解为特征向量矩阵 $ Q \in \mathbb{R}^{D \times D} $ 和特征值组成的对角矩阵 $ \Lambda \in \mathbb{R}^{D \times D} $：

$$
R = Q \Lambda Q^T,
$$

其中 $ Q $ 是正交矩阵，每一列是一个特征向量，代表了锚点特征维度上的共变模式。

我们将特征值按降序排列，对应最大特征值的特征向量捕获了特征维度之间最重要的共变模式。随后，我们从 $ Q $ 中选择前 $ M $ 个特征向量 $ P = [P_1, ..., P_M] $ 作为主要的共变方向。